@using Orders.Web.Models
@model IEnumerable<OrderItemModel>

@{
	ViewBag.Title = "View";
}

<script>
	var orderId;

	function SetDelId(targetId) {
		$('#delModal').modal('show');
		orderId = targetId;
	};

	function confirmDel() {
		var url = "/Order/Delete";
		$.post(url, { OrderId: orderId }, RedirectOnSuccess);
	};

</script>

<h2>Order List</h2>
<div class="container d-grid gap-3">
	<div class="py-2 row justify-content-start">@*@Html.ActionLink("Add New Order", "CreateOrder", "Order")*@<input type="button" class="btn btn-dark col-2" value="Add New Order" onclick="location.href='@Url.Action("CreateOrder", "Order")'" /></div>
</div>
<table class="table table-striped table-hover">
	<thead class="table-dark">
		<tr>
			<th scope="col">Order Number</th>
			<th scope="col">First Name</th>
			<th scope="col">Last Name</th>
			<th scope="col">Order Quantity</th>
			<th scope="col">Options</th>
		</tr>
	</thead>
	<tbody class="table-group-divider">
	@foreach (var order in Model)
	{
		<tr>
			<td>@order.OrderNumber</td>
			<td>@order.FirstName</td>
			<td>@order.LastName</td>
			<td>@order.Quantity</td>
			<td>@Html.ActionLink("EDIT", "Edit", "Order", new { @id = order.Id }, null) | <a class="delOrder" onclick="SetDelId(@order.Id)">DELETE</a></td>
		</tr>
	}
	</tbody>
</table>

<div class="modal" id="delModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Confirm Deletion</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<p>Are you sure you wish to delete this order? This action cannot be undone.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" id="delConfirmBtn" onclick="confirmDel()">Yes</button>
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
			</div>
		</div>
	</div>
</div>